import 'package:proxy/utils/utils.dart';

class ServerHello {
  String random;
  String keyShare;
  String sessionID;
  List<int> res = [];

  ServerHello(
      {required this.random,
      required this.keyShare,
      required String rawStr,
      required this.sessionID}) {
    res = List<int>.from(rawStr.codeUnits);
  }

  void replace(String o, List<int> n) {
    var start = indexOfElements(res, o.codeUnits);
    res.replaceRange(start, start + 32, n);
  }

  void setRandom(List<int> input) {
    replace(random, input);
  }

  void setKeyShare(List<int> input) {
    replace(keyShare, input);
  }

  void setKeySessionID(List<int> input) {
    replace(sessionID, input);
  }
}

void build() {
  String raw =
      "\x02\x00\x00\x76\x03\x03\xd7\x0c\xd6\xbb\xf0\xdb\x4b\x31\xac\x5d"
      "\xbd\x20\xd5\x48\x78\x2d\xef\xb7\x75\xd3\xd4\x0d\x6c\x1c\x9d\x26"
      "\xca\xf1\x60\x41\x36\x7b\x20\x09\xa6\xc4\xae\xee\xfb\x7b\x79\x45"
      "\x8b\x02\x7a\xda\x70\x2b\x91\xa1\xf5\xd7\x71\x97\xa8\x59\x02\x70"
      "\x7c\x9e\xa2\xf1\xd3\x90\xe9\x13\x02\x00\x00\x2e\x00\x2b\x00\x02"
      "\x03\x04\x00\x33\x00\x24\x00\x1d\x00\x20\x37\xc2\x5a\xa1\x4f\x10"
      "\x15\x9d\xd8\x24\xf7\x0d\x31\x94\x98\x5b\x5d\x15\x32\xa5\xc4\xaf"
      "\xa7\x11\xfe\xc1\x34\xb4\xbf\xf2\x3b\x4b";

  var random =
      "\xd7\x0c\xd6\xbb\xf0\xdb\x4b\x31\xac\x5d\xbd\x20\xd5\x48\x78\x2d"
      "\xef\xb7\x75\xd3\xd4\x0d\x6c\x1c\x9d\x26\xca\xf1\x60\x41\x36\x7b";

  var keyShare =
      "\x00\x33\x00\x24\x00\x1d\x00\x20\x37\xc2\x5a\xa1\x4f\x10\x15\x9d"
      "\xd8\x24\xf7\x0d\x31\x94\x98\x5b\x5d\x15\x32\xa5\xc4\xaf\xa7\x11"
      "\xfe\xc1\x34\xb4\xbf\xf2\x3b\x4b";

  var sessionID =
      "\x00\x33\x00\x2b\x00\x29\x3a\x3a\x00\x01\x00\x00\x1d\x00\x20\x12"
      "\x51\x14\x2b\x04\xf4\x50\xdc\x6f\x71\xd8\xaf\x81\x55\x24\x04\x39"
      "\xfa\xed\x09\xbf\xaf\x0b\xa3\x99\xe8\x92\xa9\xad\x5f\x50\x11";

  var temp = ServerHello(
      rawStr: raw, random: random, keyShare: keyShare, sessionID: sessionID);

  List<int> temp2 = [];
  for (var i = 0; i < 32; i++) {
    temp2.add(0);
  }

  temp.setRandom(temp2);
  temp.setKeyShare(temp2);
  temp.setKeySessionID(temp2);
  devPrint(temp.res);
}
