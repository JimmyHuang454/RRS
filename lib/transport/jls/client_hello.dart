import 'package:proxy/utils/utils.dart';

class ClientHello {
  String random;
  String keyShare;
  String sessionID;
  List<int> res = [];

  ClientHello(
      {required this.random,
      required this.keyShare,
      required String rawStr,
      required this.sessionID}) {
    res = List<int>.from(rawStr.codeUnits);
  }

  void replace(String o, List<int> n) {
    var start = indexOfElements(res, o.codeUnits);
    res.replaceRange(start, start + 32, n);
  }

  void setRandom(List<int> input) {
    replace(random, input);
  }

  void setKeyShare(List<int> input) {
    replace(keyShare, input);
  }

  void setKeySessionID(List<int> input) {
    replace(sessionID, input);
  }
}

List<int> buildChangeSpec() {
  return "\x14\x03\x03\x00\x01\x01".codeUnits;
}

void build() {
  String raw =
      "\x01\x00\x01\xfc\x03\x03\x2b\xda\xae\xad\x1d\xf9\x31\xf5\x56\x00"
      "\xc2\x99\xd4\xc7\x3a\xfe\xf1\x05\x08\x6e\x03\x45\x3d\x55\xa2\x18"
      "\x8c\x82\x49\xf3\x7d\x80\x20\x09\xa6\xc4\xae\xee\xfb\x7b\x79\x45"
      "\x8b\x02\x7a\xda\x70\x2b\x91\xa1\xf5\xd7\x71\x97\xa8\x59\x02\x70"
      "\x7c\x9e\xa2\xf1\xd3\x90\xe9\x00\x20\xba\xba\x13\x01\x13\x02\x13"
      "\x03\xc0\x2b\xc0\x2f\xc0\x2c\xc0\x30\xcc\xa9\xcc\xa8\xc0\x13\xc0"
      "\x14\x00\x9c\x00\x9d\x00\x2f\x00\x35\x01\x00\x01\x93\xba\xba\x00"
      "\x00\x00\x23\x00\x00\xff\x01\x00\x01\x00\x44\x69\x00\x05\x00\x03"
      "\x02\x68\x32\x00\x2b\x00\x07\x06\x8a\x8a\x03\x04\x03\x03\x00\x17"
      "\x00\x00\x00\x0d\x00\x12\x00\x10\x04\x03\x08\x04\x04\x01\x05\x03"
      "\x08\x05\x05\x01\x08\x06\x06\x01\x00\x2d\x00\x02\x01\x01\x00\x12"
      "\x00\x00\x00\x00\x00\x16\x00\x14\x00\x00\x11\x64\x73\x73\x31\x2e"
      "\x62\x64\x73\x74\x61\x74\x69\x63\x2e\x63\x6f\x6d\x00\x10\x00\x0e"
      "\x00\x0c\x02\x68\x32\x08\x68\x74\x74\x70\x2f\x31\x2e\x31\x00\x1b"
      "\x00\x03\x02\x00\x02\x00\x0a\x00\x0a\x00\x08\x3a\x3a\x00\x1d\x00"
      "\x17\x00\x18\x00\x05\x00\x05\x01\x00\x00\x00\x00\x00\x33\x00\x2b"
      "\x00\x29\x3a\x3a\x00\x01\x00\x00\x1d\x00\x20\x12\x51\x14\x2b\x04"
      "\xf4\x50\xdc\x6f\x71\xd8\xaf\x81\x55\x24\x04\x39\xfa\xed\x09\xbf"
      "\xaf\x0b\xa3\x99\xe8\x92\xa9\xad\x5f\x50\x11\x00\x0b\x00\x02\x01"
      "\x00\xfa\xfa\x00\x01\x00\x00\x15\x00\xc6\x00\x00\x00\x00\x00\x00"
      "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
      "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
      "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
      "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
      "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
      "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
      "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
      "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
      "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
      "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
      "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
      "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00";

  var random =
      "\x2b\xda\xae\xad\x1d\xf9\x31\xf5\x56\x00\xc2\x99\xd4\xc7\x3a\xfe"
      "\xf1\x05\x08\x6e\x03\x45\x3d\x55\xa2\x18\x8c\x82\x49\xf3\x7d\x80";
  var keyShare =
      "\x00\x33\x00\x2b\x00\x29\x3a\x3a\x00\x01\x00\x00\x1d\x00\x20\x12"
      "\x51\x14\x2b\x04\xf4\x50\xdc\x6f\x71\xd8\xaf\x81\x55\x24\x04\x39"
      "\xfa\xed\x09\xbf\xaf\x0b\xa3\x99\xe8\x92\xa9\xad\x5f\x50\x11";

  var sessionID =
      "\x09\xa6\xc4\xae\xee\xfb\x7b\x79\x45\x8b\x02\x7a\xda\x70\x2b\x91"
      "\xa1\xf5\xd7\x71\x97\xa8\x59\x02\x70\x7c\x9e\xa2\xf1\xd3\x90\xe9";

  var temp = ClientHello(
      rawStr: raw, random: random, keyShare: keyShare, sessionID: sessionID);

  List<int> temp2 = [];
  for (var i = 0; i < 32; i++) {
    temp2.add(0);
  }

  temp.setRandom(temp2);
  temp.setKeyShare(temp2);
  temp.setKeySessionID(temp2);
  devPrint(temp.res);
}
